var r,validArgs=function(){for(var r=[],e=PPx.Arguments;!e.atEnd();e.moveNext())r.push(e.value);return r},e={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",encode:"utf16le",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},useLanguage=function(){var r=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===r||"ja"===r?r:e.language},isEmptyStr=function(r){return""===r},isEmptyObj=function(r){if(r===undefined)return!1;if(null===r)return!0;for(var e in r)return!1;return!0};Array.prototype.removeEmpty||(Array.prototype.removeEmpty=function(){for(var r=[],e=0,t=this.length;e<t;e++){var n=this[e];null!=n&&""!==n&&(n instanceof Array&&0===n.length||n instanceof Object&&isEmptyObj(n)||r.push(n))}return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(r,e){var t;if(null==this)throw new TypeError('Array.indexOf: "this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return-1;var u=null!=e?e:0;if(Math.abs(u)===Infinity&&(u=0),u>=i)return-1;for(t=Math.max(u>=0?u:i-Math.abs(u),0);t<i;){if(t in n&&n[t]===r)return t;t++}return-1}),PPx.CreateObject("Scripting.FileSystemObject"),r=PPx.Extract("%*getcust(S_ppm#global:git)"),isEmptyStr(r);var _setStdin=function(r,e){return r?'-io:string,"'+r+'"':e?'io:send,"'+e.join("%bl")+'"':""},runStdout=function(r){var e=r.cmdline,t=r.wd,n=r.extract,i=void 0!==n&&n,u=r.startmsg,o=void 0!==u&&u,a=r.hide,c=void 0!==a&&a,l=r.utf8,s=void 0===l||l,p=r.single,m=r.multi,f=[c?"-noppb -hide":"-min",o?"":"-nostartmsg",t?"-d:"+t:"",s?"-io:utf8":"",_setStdin(p,m)].join(" ");i||(e="%("+e+"%)");var x=PPx.Extract("%OC %*run("+f+" "+e+")");return[Number(PPx.Extract()),x]},t="AKfycbxyhNr2JunKRnGwXhZLUpOTssHPgKsYSKrUuBTreK5z7K4rqmeKwymcaFYImvmzr7UGXA",n="https://script.google.com/macros/s",i={en:{emptyTerm:"Please specify search term",curlError:"Could not get responce"},ja:{emptyTerm:"検索語を指定してください",curlError:"取得できませんでした"}}[useLanguage()],main=function(){var r=validArgs()[0],e=PPx.Extract(getMacro(r));/^\s*$/.test(e)&&(PPx.linemessage('!"[WARN] '+i.emptyTerm),PPx.Quit(1));var u=convertURI(e),o=runStdout({cmdline:"curl -sL "+n+"/"+t+"/exec?word="+u,hide:!0}),a=o[0],c=o[1];return a>0&&(PPx.linemessage('!"[ERROR] '+i.curlError),PPx.Quit(1)),c.replace(/{"result":"(.*)"}/,"$1")},getMacro=function(r){return"edit"===r?"%*edittext()":"select"===r?"%*selecttext()":"%*cursortext()"},convertURI=function(r){var e=/(%25|%E3%80%80)/g,t={"%25":"%25%25","%E3%80%80":"+"};return encodeURI(r).replace(e,(function(r){return t[r]}))};PPx.result=main();
